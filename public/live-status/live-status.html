<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trạng thái Realtime - SportReg</title>
    <link rel="stylesheet" href="live-status.css">
    <!-- Google Fonts: Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Boxicons -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>

    <input type="checkbox" id="nav-toggle">

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-brand">
            <h2><i class='bx bx-run'></i> <span>SportReg</span></h2>
        </div>
        <div class="sidebar-menu">
            <ul>
                <li><a href="#"><i class='bx bx-grid-alt'></i> <span>Dashboard</span></a></li>
                <li><a href="#"><i class='bx bx-trophy'></i> <span>Giải đấu</span></a></li>
                <li><a href="#"><i class='bx bx-edit'></i> <span>Đăng ký</span></a></li>
                <li><a href="#" class="active"><i class='bx bx-pulse'></i> <span>Trạng thái Realtime</span></a></li>
                <li><a href="#"><i class='bx bx-user'></i> <span>Người dùng</span></a></li>
                <li><a href="#"><i class='bx bx-cog'></i> <span>Cài đặt</span></a></li>
            </ul>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header>
            <h2>
                <label for="nav-toggle"><i class='bx bx-menu'></i></label>
                Trực tiếp thi đấu
            </h2>
            <div class="user-wrapper">
                <img src="https://ui-avatars.com/api/?name=Admin+User&background=random" width="40px" height="40px" alt="Avatar">
                <div>
                    <h4>Admin User</h4>
                    <small>Quản trị viên</small>
                </div>
            </div>
        </header>

        <main>
            <div class="page-header">
                <h1>Đang diễn ra</h1>
                <div class="live-indicator">
                    <span class="blob"></span> Hệ thống Realtime đang hoạt động
                </div>
            </div>

            <!-- Grid danh sách trận đấu -->
            <div class="live-grid">
                
                <!-- Card 1: Bóng đá (Live) -->
                <div class="match-card live-active" id="match-1">
                    <div class="card-top">
                        <div class="sport-tag"><i class='bx bx-football'></i> Bóng đá</div>
                        <span class="status-badge live">LIVE 34'</span>
                    </div>
                    <div class="match-info">
                        <div class="team">
                            <div class="team-logo" style="background: #ef4444;">HC</div>
                            <span class="team-name">Hải Châu FC</span>
                        </div>
                        <div class="score-box">
                            <span class="score score-team1">2</span>
                            <span class="divider">-</span>
                            <span class="score score-team2">1</span>
                        </div>
                        <div class="team">
                            <div class="team-logo" style="background: #3b82f6;">ST</div>
                            <span class="team-name">Sơn Trà FC</span>
                        </div>
                    </div>
                    <div class="card-footer">
                        <span><i class='bx bx-map'></i> Sân A1</span>
                        <span>Bảng B - Vòng loại</span>
                    </div>
                </div>

                <!-- Card 2: Tennis (Live) -->
                <div class="match-card live-active">
                    <div class="card-top">
                        <div class="sport-tag"><i class='bx bx-tennis-ball'></i> Tennis</div>
                        <span class="status-badge live">LIVE Set 2</span>
                    </div>
                    <div class="match-info">
                        <div class="team">
                            <div class="team-logo" style="background: #10b981;">MA</div>
                            <span class="team-name">Minh Anh</span>
                        </div>
                        <div class="score-box">
                            <span class="score">6</span>
                            <span class="divider">-</span>
                            <span class="score">4</span>
                        </div>
                        <div class="team">
                            <div class="team-logo" style="background: #f59e0b;">QA</div>
                            <span class="team-name">Quốc Anh</span>
                        </div>
                    </div>
                    <div class="card-footer">
                        <span><i class='bx bx-map'></i> Sân Tennis 02</span>
                        <span>Chung kết đơn nam</span>
                    </div>
                </div>

                <!-- Card 3: Cầu lông (Sắp diễn ra) -->
                <div class="match-card">
                    <div class="card-top">
                        <div class="sport-tag"><i class='bx bx-ball'></i> Cầu lông</div>
                        <span class="status-badge upcoming">14:30</span>
                    </div>
                    <div class="match-info">
                        <div class="team">
                            <div class="team-logo" style="background: #6366f1;">T1</div>
                            <span class="team-name">Team 1</span>
                        </div>
                        <div class="score-box upcoming">
                            <span>VS</span>
                        </div>
                        <div class="team">
                            <div class="team-logo" style="background: #ec4899;">T2</div>
                            <span class="team-name">Team 2</span>
                        </div>
                    </div>
                    <div class="card-footer">
                        <span><i class='bx bx-map'></i> Nhà thi đấu</span>
                        <span>Đôi nam nữ</span>
                    </div>
                </div>

                <!-- Thêm các card khác tương tự -->

            </div>
        </main>
    </div>

    <!-- Nhúng thư viện Socket.io -->
    <script src="/socket.io/socket.io.js"></script>
    <script>
        // 1. Kết nối đến Server
        const socket = io();

        // 2. Lắng nghe sự kiện 'score_updated'
        socket.on('score_updated', (data) => {
            console.log('Nhận dữ liệu mới:', data);
            
            // Tìm thẻ HTML tương ứng với matchId (ví dụ: match-1)
            const matchCard = document.getElementById(`match-${data.matchId}`);
            if (matchCard) {
                // Cập nhật con số trên màn hình
                matchCard.querySelector('.score-team1').textContent = data.score1;
                matchCard.querySelector('.score-team2').textContent = data.score2;
                
                // Hiệu ứng nháy màu để báo hiệu (Optional)
                matchCard.style.borderColor = '#ef4444';
                setTimeout(() => matchCard.style.borderColor = 'transparent', 500);
            }
        });
    </script>
</body>
</html>